<!DOCTYPE html>
<html>
<title>VDA: Shurayrah Island</title>
<head>
  <meta charset="utf-8" />
  <html lang="en">
  <meta name="description" content="">
  <meta name="author" content="">
  <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
  <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>

 <!--jQuery-->
  <script src="js/jquery.js" type="text/javascript"></script>
  <script src="js/main.js" type="text/javascript"></script>
  <link rel="stylesheet" href="http://code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css" />
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
  <script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>

  <link rel="stylesheet" type="text/css" href="css/styleSswitch.css" />
  <script type="text/javascript" src="js/Sswitch.js"></script>

  <!--Basic jQUery Photo Slider-->
  <link rel="stylesheet" href="css/bjqs.css">
  <link rel="stylesheet" href="css/demo.css">
  <script src="js/bjqs-1.3.min.js"></script>
  <script src="js/bjqs-1.3.min2.js"></script>
  
  <!--Stylesheet-->
  <link rel="stylesheet" href="inc/style.css" />
  <!--<link rel="icon" href="img/BFC_logo_icon.png">-->
  
  <!--Custom JS-->
  <script type="text/javascript" src="inc/initiators.js"></script>
  
  <!--Mapbox API-->
  <meta name='viewport' content="initial-scale=1,maximum-scale=1,user-scalable=no" />
  <link href='https://api.mapbox.com/mapbox.js/v3.1.1/mapbox.css' rel='stylesheet' />
  
  <!--Fonts-->
  <link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
  <link href="http://fonts.googleapis.com/css?family=Lato:300italic,400italic,600italic,700italic,400,300,600,700" rel="stylesheet" type="text/css">

  <!--CartoDB and Mapbox-->
  <link rel="stylesheet" href="css/light-theme.css">
  <link rel="stylesheet" href="css/makeitresponsive.css">
  <link rel="stylesheet" href="https://cartodb-libs.global.ssl.fastly.net/cartodb.js/v3/3.15/themes/css/cartodb.css" />  
  <script src="https://cartodb-libs.global.ssl.fastly.net/cartodb.js/v3/3.15/cartodb.uncompressed.js"></script>
  <script src="https://api.tiles.mapbox.com/mapbox.js/v2.2.1/mapbox.standalone.js"></script>

  <!--Leaflet --> 
  <!--
  <link rel="stylesheet" href="css/leaflet.draw.css"/>
  <script src="js/leaflet.draw.js"></script>-->
  
  <!--Google API-->
  <script type="text/javascript" src="https://www.google.com/jsapi"></script>
  
  <!--Yellow AOI polygon-->
  <!--<script src="src/Waterbodies.js"></script>
  <script src="src/Rivers.js"></script>
  <script src="src/HUC10.js"></script>-->     

  <!--[if lte IE 8]>
    <link href='http://api.tiles.mapbox.com/mapbox.js/v1.3.1/mapbox.ie.css' rel='stylesheet' >
  <![endif]-->

  <!-- Leaflet Plugins -->
  <link rel="stylesheet" href="src/Control.MiniMap.css" />
  <script src="src/Control.MiniMap.js" type="text/javascript"></script>
  
  
  <!--
  <script>
    // JQuery Modal Dialog
	$(function() {
	$("#dialogContainer").dialog({
	title: 'ONLINE VIEWER TOOL',
	resizable: true,
	bgiframe: true,
	background: "black",
	overlay: { opacity: 0.5, background: "white" },
	autoOpen: true,
	height: 1000,
	width: 1000,
	modal: true,
	});
	});
  </script>
 -->

  <!--[if lte IE 8]>
    <link href='http://api.tiles.mapbox.com/mapbox.js/v1.3.1/mapbox.ie.css' rel='stylesheet' >
  <![endif]-->

  <!-- Leaflet Plugins 
  <link rel="stylesheet" href="src/Control.MiniMap.css" />
  <script src="src/Control.MiniMap.js" type="text/javascript"></script>-->
  

	<style>
	body{
		font: 60% "Lato", sans-serif;
	}

	#dialog.Container {
    	width: 500px;
    	height: 500px;
	}
	
	#dialog-link {
		padding: .4em 1em .4em 20px;
		text-decoration: none;
		position: absolute;
	}
	#dialog-link span.ui-icon {
		margin: 0 5px 0 0;
		position: absolute;
		left: .2em;
		top: 0%;
		margin-top: -8px;
	}
	#icons {
		margin: 0;
		padding: 0;
	}
	#icons li {
		margin: 2px;
		position: relative;
		padding: 4px 0;
		cursor: pointer;
		float: left;
		list-style: none;
	}
	#icons span.ui-icon {
		float: left;
		margin: 0 4px;
	}
	.fakewindowcontain .ui-widget-overlay {
		position: absolute;
	}
	select 
	{
		width: 200px;
	}
	
	#format
	{
		text-align: center;
	} 
  
	#screenshot{
		position:absolute;
		border:1.5px solid #000;
		background:#FFF;
		padding:3px;
		display:none;
		color:#fff;
		z-index:101;
	}	  
  
    html, body {
        height: 100%;
        padding: 0;
        margin: 0;
      }
  
	input[type="radio"]{
	 vertical-align: middle;
	}

	input[type="checkbox"]{
	 vertical-align: middle;
	}

    #layer_selector {
        position: absolute;
        top: 4px;
        right: 30px;
      }
	
	#button {
		position:absolute;
		bottom: 5px;
		left: 5px;
	}

	#myWB {
	  width:150px;   
	}	

	.overlay {
	  position: absolute;
	  top: 0;
	  bottom: 0;
	  left: 0;
	  right: 0;
	  background: rgba(0, 0, 0, 0.7);
	  transition: opacity 500ms;
	  visibility: hidden;
	  opacity: 0;
	}
	.overlay:target {
	  visibility: visible;
	  opacity: 1;
	}

	.popup {
	  margin: 50px auto;
	  padding: 15px;
	  background: #fff;
	  border-radius: 5px;
	  width: 35%;
	  position: relative;
	  right: 10%;
	  transition: all 5s ease-in-out;
	  z-index:101;
	}

	.popup h2 {
	  margin-top: 0;
	  color: #333;
	  font-family: "Trebuchet MS", sans-serif;
	}
	.popup .close {
	  position: absolute;
	  top: 0px;
	  right: 10px;
	  transition: all 200ms;
	  font-size: 30px;
	  font-weight: bold;
	  text-decoration: none;
	  color: #333;
	}
	.popup .close:hover {
	  color: orange;
	}
	.popup .content {
	  max-height: 50%;
	  overflow: auto;
	  padding: 15px;
	}	

	.info {
		padding: 6px 8px;
		font: 14px/16px Verdana, Geneva, sans-serif;
		background: white;
		background: rgba(255,255,255,1);
		box-shadow: 0 0 15px rgba(0,0,0,0);
		border-radius: 5px;
		border:1px solid #000;
		position:absolute;
		left: 6px;
		top: 265px;
	}
	

	.legend {
		line-height: 18px;
		color: #555;
	}
	.legend i {
		width: 18px;
		height: 18px;
		float: left;s
		margin-right: 8px;
		opacity: 0.7;
	}
	
	@media (hover: none) {
	  .leaflet-tooltip-pane { display: none; }
	}	

	.ui-tabs .ui-tabs-nav{
		background: rgba(40, 92, 148, 0.75);

	}

	#tabs .ui-state-active {
		background: rgba(200, 200, 200, 1);
	}

	#ui-tabs #ui-tabs-panel 
		|/* just in case you want to change the panel */
	{
		background: black;
	}
	
	.film-background {
	   z-index: -1;
	   position: absolute;
	   top: 0;
	   left: 0;
	   width: 100%;
	}

	#slider {
		margin: 5px;
	}
	.ui-slider-horizontal {
		height: 10px;
		width: 150px;
	}
	.ui-slider .ui-slider-handle {
		height: 10px;
		width: 5px;
		padding-left: 5px;
		padding-bottom: 5px;
	}


	* {
	  box-sizing: border-box;
	}


	.autocomplete {
	  /*the container must be positioned relative:*/
	  position: relative;
	  display: inline-block;
	}

	.autocomplete-items {
	  position: absolute;
	  border: 1px solid #d4d4d4;
	  border-bottom: none;
	  border-top: none;
	  z-index: 99;
	  /*position the autocomplete items to be the same width as the container:*/
	  top: 95%;
	  left: 5%;
	  right: 0;
	}
	.autocomplete-items div {
	  padding: 10px;
	  cursor: pointer;
	  background-color: #fff; 
	  border-bottom: 1px solid #d4d4d4; 
	}
	.autocomplete-items div:hover {
	  /*when hovering an item:*/
	  background-color: #6baed6; 
	}
	.autocomplete-active {
	  /*when navigating through the items using the arrow keys:*/
	  background-color: DodgerBlue !important; 
	  color: #ffffff; 
	}  
	 
	.centerText{
	   text-align: center; 
	}

	#page{
		display:none;
	}

	#loading {
	  display: block;
	  position: absolute;
	  top: 0;
	  left: 0;
	  z-index: 100;
	  width: 100vw;
	  height: 100vh;
	  background-color: rgba(192, 192, 192, 1);
	  background-image: url("https://i.stack.imgur.com/MnyxU.gif");
	  background-repeat: no-repeat;
	  background-position: center;
	}


	.my-legend .legend-title {
	    text-align: left;
	    margin-bottom: 8px;
	    font-weight: bold;
	    font-size: 90%;
	    }
	.my-legend .legend-scale ul {
	    margin: 0;
	    padding: 0;
	    float: left;
	    list-style: none;
	    }
	.my-legend .legend-scale ul li {
	    display: block;
	    float: left;
	    width: 25px;
	    margin-bottom: 6px;
	    text-align: center;
	    font-size: 80%;
	    list-style: none;
	    }
	.my-legend ul.legend-labels li span {
	    display: block;
	    float: left;
	    height: 15px;
	    width: 25px;
	    }
	.my-legend .legend-source {
	    font-size: 70%;
	    color: #999;
	    clear: both;
	    }
	.my-legend a {
	    color: #777;
	    }
	.my-legend .legend-scale2 ul {
	    margin: 0;
	    margin-bottom: 5px;
	    padding: 0;
	    float: left;
	    list-style: none;
	    }
	.my-legend .legend-scale2 ul li {
	    font-size: 80%;
	    list-style: none;
	    margin-left: 0;
	    line-height: 18px;
	    margin-bottom: 2px;
	    }
	.my-legend ul.legend-labels2 li span {
	    display: block;
	    float: left;
	    height: 16px;
	    width: 25px;
	    margin-right: 0px;
	    margin-left: 0;
	    border: 0px solid #999;
	    }

    </style>


    <script>
        function myFunction()
        {
            document.getElementById("page").style.display = "block";
            document.getElementById("loading").style.diplay = "none";
        }
    </script>
</head>

<body>

<div class="page"> 
	
	<!--<div id="dialogContainer" title="ONLINE VIEWER">
	<p><b>HEADING</b></p>
	<br><br>
	<p>BODY</p>
	<br>
	<center><img src="img/BFC_logolockup_web.png"></center>
	</div>-->
	</div>

<div class="map" id="map"></div>



<div id="popup1" class="overlay">
	<div class="popup">
		<a class="close" href="#">Ã—</a>
		<div class="content">
			<h2>Documentation</h2>	
			<p><b>Enhancement Objectives</b><br><br>Value Driven Approach (VDA). A suite of challenges, including xxx.
			</p>
			<p>Here we highlight the risk of xxx, and the intersection of these risks and opportunities to better understand the value of implementing the 50% CMP across project stage gates across the RSP.</p>
		</div>
	</div>
</div>

<div id="popup2" class="overlay">
	<div class="popup">
		<a class="close" href="#">Ã—</a>
		<div class="content">
			<b>Environmental Feedback Interpretation</b>
			<p>xxx</p>
		</div>
	</div>
</div>

<div class="sidepanel">


<!-- JQuery Tabs -->
<div id="tabs">
	<ul>
		<li><a href="#tabs-1"><b>RISKS</b></a></li>	
		<li><a href="#tabs-2"><b>ENHANCE</b></a></li>	
		<li><a href="#tabs-3">&#8505;</a></li>	
		<li><a href="#tabs-4">&#8593;</a></li>
	</ul>


<div id="tabs-1">
	<fieldset> <!--style="width:375px;"-->
	<legend><img src="img/strategies_sm.png" valign="middle">&nbsp;<b>VDA Objectives</b>&nbsp;&nbsp;<a class="button" href="#popup1"><img src="img/info_sm.png" valign="middle" title="Click to get info" ></a></legend>
	<ol>
	<li>Risk to Habitats<input type="checkbox" name="checkboxName1" class="checkbox1" id="checkbox1" /></li>
	<li>Potential for Values Enhancement<input type="checkbox" name="checkboxName2" class="checkbox2" id="checkbox2" /></li>
	<li>Risk + Supply (Bivariate map)<input type="checkbox" name="checkboxName3" class="checkbox3" id="checkbox3" /></li>
		</ol>

	<div id="accordion"> 
	<h4>&nbsp;</h4>
	<div>
	Showing the combine index scores for all habitats:<br>
	mangroves, mudflats, sabkha, and sandy beaches<p></p>
	<div class='my-legend'>
	<div class='legend-title'>VDA Risk/Opportunity Index</div>
	<div class='legend-scale'>
	  <ul class='legend-labels'>
	    <li><span style='background:#1a9641;'></span>High</li>
	    <li><span style='background:#a6d96a;'></span></li>
	    <li><span style='background:#ffffbf;'></span>Med</li>
	    <li><span style='background:#fdae61;'></span></li>
	    <li><span style='background:#d7191c;'></span>Low</li>
	  </ul>
	</div>
	<div class='legend-source'>Source: <a href="https://www.google.com" target="_blank">BDC | KAU </a></div>
	</div>	 
	</div>
	
	<h4>&nbsp;</h4>
	<div>
	In some cases, removing xxx can lead to increased xxx supply available for xxx communities. Using remote-sensing tools, this map shows the potential for xxx.<p></p>
	<div class='my-legend'>
	<div class='legend-title'>Potential for Natural Capital Supply Enhancement</div>
	<div class='legend-scale'>
	  <ul class='legend-labels'>
	    <li><span style='background:#ECF0F6;'></span>Low</li>
	    <li><span style='background:#B2C2DB;'></span></li>
	    <li><span style='background:#849EC5;'></span>Intermed</li>
	    <li><span style='background:#6182B5;'></span></li>
	    <li><span style='background:#43618F;'></span>High</li>
	  </ul>
	</div>
	<div class='legend-source'>Source: <a href="#link to source">xxx</a></div>
	</div>
	<hr>
	<br>
	<div class='my-legend'>
	<div class='legend-title'>Find an activity by code:</div>
	</div>
	<input id='myWB' class='waterbody' type='text' name='myWB' placeholder="Enter name" onclick="clearText();"> <button onclick="zoomWB();">Zoom</button>
	</div>

	<h4>&nbsp;</h4>
	<div>
	xxx risk estimates interact with the xxx impact, xxx<p></p>
	<div class='my-legend'>
	<div class='legend-title'>Bivariate Map<br><i>xxx Risk vs. ES Supply</i></div>
	<div class='legend-scale2'>
	  <ul class='legend-labels2'>
	    <li><span style='border:#fff;'>High</span><span style='background:#64acbe;'></span><span style='background:#627f8c;'></span><span style='background:#574249;'></span></li>
	    <li><span style='border:#fff;'>Med</span><span style='background:#b0d5df;'></span><span style='background:#ad9ea5;'></span><span style='background:#985356;'></span></li>
	    <li><span style='border:#fff;'>Low</span><span style='background:#e8e8e8;'></span><span style='background:#e4acac;'></span><span style='background:#c85a5a;'></span></li>
	     <li><span style='border:#fff;'></span><span style='border:#fff;'>&nbsp;Low</span><span style='border:#fff;'>&nbsp;Med</span><span style='border:#fff;'>&nbsp;High</span></li>   

	  </ul>
	</div>
	<div class='legend-source'>Source: <a href="#link to source">BDC | EMC</a></div>
	</div>
	</div> <!-- end accordian -->
	</fieldset>
	</div>

	<div id="tabs-2">
	<fieldset>
	 <legend><img src="img/snapshot_sm.png" valign="middle">&nbsp; <b>Habitat Photos</b></legend>
	 The Value Driven Approach (VDA) serves to xxx.<br><br>
	<div id="banner-slide">
	<ul class="bjqs">
		<li><img src="img/1.png" title="Dense mangrove"></li>
		<li><img src="img/2.png" title="Sparse mangrove"></li>
		<li><img src="img/3.png" title="Intertidal mudflats"></li>
		<li><img src="img/4.png" title="Sabkha with microbial mats"></li>
		<li><img src="img/5.png" title="Sandy beach"></li>
	</ul>
	</div>
	<div class="controlgroup">
      <select id="scale">
        <option value="0">Learn more...</option>
        <option value="1">How it works</option>
        <option value="2">Why you should care</option>
        <option value="3">How it's different</option>			
      </select>
	</div>
	<br>
	<div id="test1"></div>
	</fieldset>	
	</div>


	<!--
	<div id="tabs-4">
	<fieldset>
	 <legend><b>Case Study Tour</b></legend>
	<br>Click the button for a tour of the TSCI case study.<br><br> 
	<div class="play" id="a">play</div>
	<audio id="sound1">
    <source src="http://www.bigsoundbank.com/sounds/ogg/0595.ogg" type="audio/ogg" />
	</audio>
	</fieldset>	
	</div>
	-->

	<div id="tabs-3">
	<fieldset>
	 <legend><img src="img/cc_sm.png" valign="middle">&nbsp; <b>About the RSP Team</b></legend>
	 <div id="banner-slide2">
	<ul class="bjqs">
		<li><img src="img/1_BDC.png" title="<b><a href='https://www.google.com' target='_blank'>Beacon Development Company</a>:</b><br>ESIA Consultant for Shurayrah Island"></li>
		<li><img src="img/1_BDC.png"></li>
		<li><img src="img/1_BDC.png"></li>
		<li><img src="img/1_BDC.png"></li>
	</ul>
	</div>
	<br><br>
	</fieldset>	
	</div>
	</div>

	<div id="tabs-4">
	<br>
	</div>	

</div>

<div id="loading"></div> 

<script>
	function onReady(callback) {
	  var intervalId = window.setInterval(function() {
	    if (document.getElementsByTagName('body')[0] !== undefined) {
	      window.clearInterval(intervalId);
	      callback.call(this);
	    }
	  }, 3000);
	}

	function setVisible(selector, visible) {
	  document.querySelector(selector).style.display = visible ? 'block' : 'none';
	}

	onReady(function() {
	  setVisible('.page', true);
	  setVisible('#loading', false);
	});


$( document ).ready(function() {
  
  // bjqs slider
  $('#banner-slide').bjqs({
    animtype      : 'slide',
    height        : 337,
    width         : 449,
    responsive    : true,
    randomstart   : false,

	animtype        : 'fade',
	animduration    : 300,      // length of transition
	animspeed       : 5000,     // delay between transitions
	automatic       : true,     // enable/disable automatic slide rotation

	// control and marker configuration
	showcontrols    : true,     // enable/disable next + previous UI elements
	centercontrols  : true,     // vertically center controls
	nexttext        : '>',   // text/html inside next UI element
	prevtext        : '<',   // text/html inside previous UI element
	showmarkers     : true,     // enable/disable individual slide UI markers
	centermarkers   : true,     // horizontally center markers
	});

  
  // bjqs slider
  $('#banner-slide2').bjqs({
    animtype      : 'slide',
    height        : 165,
    width         : 385.5,
    responsive    : true,
    randomstart   : false,

	animtype        : 'fade',
	animduration    : 300,      // length of transition
	animspeed       : 5000,     // delay between transitions
	automatic       : true,     // enable/disable automatic slide rotation

	// control and marker configuration
	showcontrols    : false,     // enable/disable next + previous UI elements
	centercontrols  : true,     // vertically center controls
	nexttext        : '>',   // text/html inside next UI element
	prevtext        : '<',   // text/html inside previous UI element
	showmarkers     : true,     // enable/disable individual slide UI markers
	centermarkers   : true,     // horizontally center markers
	});

	//$( "#tabs" ).tabs({ active: 4}); 
	$( "#tabs" ).tabs(); 
	//$("#accordion").accordion({ header: "h4", collapsible: true, active: 0, heightStyle: 'panel' });
	$("#accordion").accordion({ header: "h4", collapsible: true, heightStyle: 'content' });
	$( "#tabs" ).tabs();
    $( "#check" ).button();
    $( "#format" ).buttonset();
	$( "#tooltip" ).tooltip();
	//$("#accordion").accordion({ active: 4});

});

		/////////////////////////////////////////////////////////////////////////////
	
	var ckb1 = 0;
	var ckb2 = 0;
	var ckb3 = 0;
	
	
	$(".checkbox1").Sswitch({
		onSwitchChange: function() {

		 if($("#checkbox1").is(':checked') && ckb1 == 0){
			//activateFire = 1;
			showFire();
			$("#tabs").tabs({ active: 0});$("#accordion").accordion({ active: 0});
			if($("#checkbox2").is(':checked') && ckb2 == 1){ $('.checkbox2').trigger('click');}
			if($("#checkbox3").is(':checked') && ckb3 == 1){ $('.checkbox3').trigger('click');}
			ckb1 = 1;
		 }
		 
		 else{
			clearFire();
			if ($( "#accordion" ).accordion( "option", "active" ) == 0){
				$("#tabs").tabs({ active: 0});$("#accordion").accordion({ active: 4});
			}		
			ckb1 = 0;				
		 }	 
		}
	});		
	
	$(".checkbox2").Sswitch({
		onSwitchChange: function() {	
			
		 if($("#checkbox2").is(':checked') && ckb2 == 0){
			//activateWater = 1;
			showWY(); 
			$("#tabs").tabs({ active: 0});$("#accordion").accordion({ active: 1});
			if($("#checkbox1").is(':checked') && ckb1 == 1){ $('.checkbox1').trigger('click');}
			if($("#checkbox3").is(':checked') && ckb3 == 1){ $('.checkbox3').trigger('click');}
			ckb2 = 1;
		 }
		
		 else{
			clearWY(); 
			if ($( "#accordion" ).accordion( "option", "active" ) == 1){
				$("#tabs").tabs({ active: 0});$("#accordion").accordion({ active: 4});
			}		
			ckb2 = 0;				
		 }	 
		}
	});	

	
	$(".checkbox3").Sswitch({
		onSwitchChange: function() {
	
		 if($("#checkbox3").is(':checked') && ckb3 == 0){
			//activateBivar = 1;
			showBivar(); 
			$("#tabs").tabs({ active: 0});$("#accordion").accordion({ active: 2});
			if($("#checkbox1").is(':checked') && ckb1 == 1){ $('.checkbox1').trigger('click');}
			if($("#checkbox2").is(':checked') && ckb2 == 1){ $('.checkbox2').trigger('click');}
			ckb3 = 1;
		 }

		 else{
			clearBivar(); 
			if ($( "#accordion" ).accordion( "option", "active" ) == 2){
				$("#tabs").tabs({ active: 0});$("#accordion").accordion({ active: 4});
			}		
			ckb3 = 0;	
		 }	 
		}
	});	

	

	setTimeout(function() {  
	map.setView([25.50, 36.975], 14);
	//showWB();
	//showRivers();

	// select the fire risk checkbox
	//showFire();
	$('.checkbox1').trigger('click');
	$("#checkbox1").prop("checked", true);
	$(".accordion").accordion({ active: 0});
	ckb1 = 1;
	//endFire = 1;
  	}, 4000);  

	/*	
  $( "#slider1" ).slider({
   	change: function(event, ui) {} ,
  	//change: function(event, ui) {showWY(ui.value);} ,
	   orientation: "horizontal",
	   value: 80,
	   step:10,
	   min: 0,
       max: 90	,
	   slide: function( event, ui ){
		$( "#minval1" ).val( ui.value );
	   }	
	});
	$( "#minval1" ).val( $( "#slider1" ).slider( "value" ) );	
	

  $( "#slider2" ).slider({
  	change: function(event, ui) {} ,
	   orientation: "horizontal",
	   value: 0,
	   step:10,
	   min: 0,
       max: 90	,
	   slide: function( event, ui ){
		$( "#minval2" ).val( ui.value );
	   }	
	});
	$( "#minval2" ).val( $( "#slider2" ).slider( "value" ) );	
	*/
 
	
///////////////////////////////////////////////////////////////////////////////////


var sql = new cartodb.SQL({ user: 'gverutes' });
	

// base maps
var ESRIImagery = L.tileLayer('http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
	attribution: 'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, and UPR-EGP'
});
var OSM = L.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {attribution: '&copy; <a href="http://www.openstreetmap.org">OpenStreetMaps</a>'});
var MapboxStreets = L.tileLayer('http://a.tiles.mapbox.com/v3/geointerest.afb8c76d/{z}/{x}/{y}.png', {attribution: '&copy; <a href="http://www.mapbox.com">Mapbox</a>'});

// try: mapbox.streets >> https://docs.mapbox.com/help/troubleshooting/migrate-legacy-static-images-api/#how-to-tell-if-your-current-implementation-uses-a-mapbox-designed-classic-style

// map settings
L.mapbox.accessToken = 'pk.eyJ1IjoiZ2VvaW50ZXJlc3QiLCJhIjoiQ2czbnlDMCJ9.pQ-_LxzHCL6WqMm5rJrEWw';

	
// set base map and controls
var map = new L.Map('map', {
  zoomControl: false,
  layer_selector: true,
  layers: [ESRIImagery],
  center: [25.50, 36.96],
  zoom: 6,
  minZoom: 4,
  maxZoom: 17
});

// scroll wheel
//map.scrollWheelZoom.disable();


//var southWest = L.latLng(28, -140),
//northEast = L.latLng(45, -95);
//var bounds = L.latLngBounds(southWest, northEast);

//map.setMaxBounds(bounds);
//map.on('drag', function() {
//    map.panInsideBounds(bounds, { animate: false });
//});

map.attributionControl.setPrefix('Viewer: <a href="http://cons.scienceontheweb.net" target="_blank">G. Verutes</a>');
	
// add basemap and overlays
var baseMaps = {
	"<b>blank</b>": MapboxStreets,
	"<b>street</b>": OSM,
	"<b>satellite</b>": ESRIImagery,
};
/*
// add Leaflet vector
var b1 = new L.LatLng(5.9,-55.1);
var b2 = new L.LatLng(5.8,-55.2);
var b12 = [b1, b2];
var basins = new L.polyline(b12, {
	color: '#023858',
	weight: 0,
	opacity: 0,
	smoothFactor: 0,
	});	

var w1 = new L.LatLng(5.9,-55.1);
var w2 = new L.LatLng(5.8,-55.2);
var w12 = [w1, w2];
var w12_line = new L.polyline(w12, {
	color: '#023858',
	weight: 0,
	opacity: 0,
	smoothFactor: 0,
	});	

var r1 = new L.LatLng(5.9,-55.1);
var r2 = new L.LatLng(5.8,-55.2);
var r12 = [r1, r2];
var r12_line = new L.polyline(r12, {
	color: '#023858',
	weight: 0,
	opacity: 0,
	smoothFactor: 0,
	});		
 */
// street view	
 var streetIcon = L.Icon.Default.extend({
	options: {
			iconUrl: 'img/marker-icon-blue.png' ,
			iconSize:     [20, 20],  // size of the icon
			iconAnchor:   [9, 19],
			popupAnchor:  [-2, -12]  			
	}
 });

var streetIcon = new streetIcon();
streetIcon.options.shadowSize = [0,0];

var string1 = "<center><b>Instant Street View</b><a href=\'http://www.instantstreetview.com/s/"
var string2 = "&mode=sequential\' target=\'_blank\'><br>CLICK TO LAUNCH</a></center>"
var SV1 = L.marker([25.5008, 36.9744], {icon: streetIcon}).bindPopup("TEST");
var SV2 = L.marker([25.49733, 36.94188], {icon: streetIcon}).bindPopup("TEST");
//var SV3 = L.marker([25.5008, 36.9744], {icon: streetIcon}).bindPopup("string1+"23.96103,52.177928"+string2");

var streets = L.layerGroup([SV1, SV2]);

// add CartoDB viz.json
//var layerBasins = 'xxx'
var layerSubregions= 'https://stanford.carto.com/u/gverutes/api/v2/viz/41c9893b-9db9-4ff7-952d-dc71c31598cf/viz.json';
var layerWB = 'https://stanford.carto.com/u/gverutes/api/v2/viz/3e4869d6-8684-4517-9f37-9c55527de754/viz.json';
var layerRivers = 'https://stanford.carto.com/u/gverutes/api/v2/viz/af3383fc-b4f4-41f3-b851-b9b82c386f10/viz.json';
var layerWY = 'https://stanford.carto.com/u/gverutes/api/v2/viz/c95af2a9-e71b-4f00-9d27-90647c51e56f/viz.json'
var layerFire = 'https://stanford.carto.com/u/gverutes/api/v2/viz/8ae1ec57-88c7-48de-9c22-ad24379f0ecb/viz.json'
var layerBivar = 'https://stanford.carto.com/u/gverutes/api/v2/viz/ab4b485c-36f2-4e55-bb56-b78d04eab1d9/viz.json'


/////////////////////////////
/*
// set base style of grid
function style(feature) {
  return {
	weight: 0,
	fillOpacity: 0.75,
	fillColor: '#c6dbef',
	color:'#c6dbef' 
  };
}

function style2(feature) {
  return {
	weight: 1.5,
	fillOpacity: 0.75,
	fillColor: '#c6dbef',
	color:'#c6dbef' 
  };
}

function style3(feature) {
  return {
	weight: 0,
	fillOpacity: 0,
	fillColor: '#c6dbef',
	color:'#c6dbef'
	//hovertip: false, 
  };
}

// set hover colors
function highlightFeature(e) {
	var layer = e.target;
	layer.setStyle({
		weight: 3,
		opacity: 0.25,
		color: '#EFFD5F', 
		dashArray: '3',
		fillOpacity: 0.2,
		fillColor: '#2171b5'
		//hovertip: false,
	});
}

function highlightFeature2(e) {
	var layer = e.target;
	layer.setStyle({
		weight: 2,
		opacity: 0.35,
		color: '#000', 
		//dashArray: '2',
		fillOpacity: 0.1,
		fillColor: '#fff',
	});
}

// a function to reset the colors when a neighborhood is no longer 'hovered'
function resetHighlight(e) {
	geojson.resetStyle(e.target);
	geojson2.resetStyle(e.target);
	geojson3.resetStyle(e.target);
}

function zoomToFeature(e) {
	map.fitBounds(e.target.getBounds());
}

function onEachFeature(e) {
	// turnoff watersheds/json
	map.removeLayer(geojson3);
	setTimeout(function() {  
	// turn on watershed json
	map.addLayer(geojson3)
  	}, 7500);  

}

// tell what functions to call when mousing over and out of a neighborhood
// add vector data to map
geojson = L.geoJson(grid, {
	style: style,
	onEachFeature: function (feature, layer) {
	layer.on({
	mouseover: highlightFeature,
	mouseout: resetHighlight
	});

	  }
	});

geojson2 = L.geoJson(grid2, {
	style: style2,
	onEachFeature: function (feature, layer) {
	layer.on({
	mouseover: highlightFeature,
	mouseout: resetHighlight
	});

	  }
	});

geojson3 = L.geoJson(grid3, {
	style: style3,
	onEachFeature: function (feature, layer) {
	layer.on({
	mouseover: highlightFeature2,
	mouseout: resetHighlight,
	//click: zoomToFeature
	click: onEachFeature
	});

	  }
	});


function openMarkerPopup(id){
	geojson.eachLayer(function(feature){
		if(feature.feature.properties.id==id){
			feature.openPopup();
		}
	});
}    
map.closePopup();
*/



/*
var waterbodies= L.layerGroup([w12_line, geojson]);
var rivers = L.layerGroup([r12_line, geojson2]);
*/
// add cartoDB layer and set z-index so it shows up on top
cartodb.createLayer(map, layerSubregions)
.on('done', function(layer) {
	//layerSubregions.setZIndex(100);
	var overlayMaps = {
	//"habitats": habitats,
	//"mitigation": rivers,
	"enhancement": streets,
	//"stressors": geojson3,
	"subregions": layer.addTo(map),
	};
	L.control.layers(baseMaps, overlayMaps, {position: 'topleft', collapsed: false}).addTo(map);
	//layer.addTo(map);
});



// mini map
//var ESRIStreetMap = 'http://server.arcgisonline.com/arcgis/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}.png';
//var StamenToner = 'http://a.tile.stamen.com/toner/{z}/{x}/{y}.png'
var CartoLight = 'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png'
//var MapboxStreets = 'http://a.tiles.mapbox.com/v3/geointerest.e4qjes5f/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiZ2VvaW50ZXJlc3QiLCJhIjoiQ2czbnlDMCJ9.pQ-_LxzHCL6WqMm5rJrEWw';
var mb = new L.TileLayer(CartoLight, {minZoom: 3, maxZoom: 12});
var miniMap = new L.Control.MiniMap(mb, { toggleDisplay: true, height: '150', width: '112'}).addTo(map); 

// zoom control
L.control.zoom({ position: 'topright' }).addTo(map);
// scale
L.control.scale({ position: 'topleft' }).addTo(map);


// habs
cartodb.createLayer(map, 'https://stanford.carto.com/u/gverutes/api/v2/viz/a2d0e59c-954e-4ffe-808c-7ed9d0ca8c5a/viz.json')
		.addTo(map)
        .on('done', function(layer) {
		layer.setZIndex(26);	
});

// landmass polygon
cartodb.createLayer(map, 'https://stanford.carto.com/u/gverutes/api/v2/viz/543b6ac6-44e6-4901-9190-50f5105c42d5/viz.json')
		.addTo(map)
        .on('done', function(layer) {
		layer.setZIndex(25);	
});

// subregion base
cartodb.createLayer(map, 'https://stanford.carto.com/u/gverutes/api/v2/viz/18110103-2261-4767-8ec2-3b6b61759dde/viz.json')
		.addTo(map)
        .on('done', function(layer) {
		layer.setZIndex(24);	
});



///////////////////////////////////////////////////////////////////////

var sql = cartodb.SQL({ user: 'gverutes' });

///////////////////////////////////////////////////////////////////////

function clearText(){document.getElementById('myWB').value = ''}

/*
map.on('overlayadd', onOverlayAdd);

function onOverlayAdd(e){
    if (e.name == 'rivers'){showRivers();} //showRivers();
	else if (e.name == 'waterbodies'){showWB();} //showWB();
	//else if (e.name == 'basins (TSCI)'){showBasins();} //showUrban();
}

map.on('overlayremove', onOverlayRemove);

function onOverlayRemove(e){
	if (e.name == 'rivers'){clearRivers();} //clearRivers();
	else if (e.name == 'waterbodies'){clearWB();} //clearWB();
	//else if (e.name == 'basins (TSCI)'){clearBasins();} //clearUrban();
}
*/

///////////////////////////////////////////////////////////////////////

$("#scale").change(function(event){

	if ($( "#scale option:selected" ).text() == "How it works"){
		showMapTable(1);
	}
	else if ($( "#scale option:selected" ).text() == "Why you should care"){
		showMapTable(2);
	}
	else if ($( "#scale option:selected" ).text() == "How it's different"){
		showMapTable(3);
	}
})

function showMapTable(site_num){
	
	if (site_num == 1){
		var HTML1 = "ESIA consultants receive environmental feedback to integrate economic and environmental values in the development processes.";	
	
		document.getElementById("test1").innerHTML = HTML1;
	}

	else if (site_num == 2){
		var HTML1 = "By scaling restoration strategies via, TRSDC can decrease the risk of severe xxx while protecting habitat and prioritized ES values.";	
	
		document.getElementById("test1").innerHTML = HTML1;
	}	

	else if (site_num == 3){
		var HTML1 = "The VDA utilizes best-available science and data to mitigate risks and maximize enhancement opportunities.";	
	
		document.getElementById("test1").innerHTML = HTML1;
	}		
}

///////////////////////////////////////////////////////////////////////
/*
var endUrban = 0;  
var sublayersUrban = [];

function clearUrban(){

	if (endUrban > 0){sublayersUrban[endUrban-1].remove();}
	endUrban = endUrban + 1;
	
	var MapQueryUrban = "SELECT * FROM urban_tsci_nad83 WHERE cartodb_id = 1";
		
	var CartoCSSUrban = "#urban_tsci_nad83{polygon-fill: #FFFFFF;polygon-opacity: 0;line-color: #FFF;line-width: 0;line-opacity: 0;}}";
	
	  cartodb.createLayer(map, layerUrban)
	  .addTo(map)
	  .on('done', function(layer) {
		// change the query for the first layer
		var subLayerOptions = {
		  sql: MapQueryUrban,
		  cartocss: CartoCSSUrban,
		}
		var sublayer = layer.getSubLayer(0);
		sublayer.set(subLayerOptions);
		sublayersUrban.push(sublayer);
		layer.setZIndex(5);
	  }).on('error', function() {
		// log the error
	  });
}

function showUrban(){

	if (endUrban > 0){sublayersUrban[endUrban-1].remove();}
	endUrban = endUrban + 1;
	
	var MapQueryUrban = "SELECT * FROM urban_tsci_nad83";
		
	var CartoCSSUrban = "#urban_tsci_nad83{polygon-fill: #000;polygon-opacity: 0.85;line-color: #000;line-width: 0;line-opacity: 0;}";
	
	  cartodb.createLayer(map, layerUrban)
	  .addTo(map)
	  .on('done', function(layer) {
		// change the query for the first layer
		var subLayerOptions = {
		  sql: MapQueryUrban,
		  cartocss: CartoCSSUrban,
		}
		var sublayer = layer.getSubLayer(0);
		sublayer.set(subLayerOptions);
		sublayersUrban.push(sublayer);
		layer.setZIndex(5);
	  }).on('error', function() {
		// log the error
	  });
}	
*/
///////////////////////////////////////////////////////////////////////

var endWB = 0;  
var sublayersWB = [];

function clearWB(){

	if (endWB > 0){sublayersWB[endWB-1].remove();}
	endWB = endWB + 1;
	
	var MapQueryWB = "SELECT * FROM waterbodies_canv_nad83 WHERE cartodb_id = 1";
		
	var CartoCSSWB = "#waterbodies_canv_nad83{polygon-fill: #FFFFFF;polygon-opacity: 0;line-color: #FFF;line-width: 0;line-opacity: 0;}}";
	
	  cartodb.createLayer(map, layerWB)
	  .addTo(map)
	  .on('done', function(layer) {
		// change the query for the first layer
		var subLayerOptions = {
		  sql: MapQueryWB,
		  cartocss: CartoCSSWB,
		}
		var sublayer = layer.getSubLayer(0);
		sublayer.set(subLayerOptions);
		sublayersWB.push(sublayer);
		layer.setZIndex(7);
	  }).on('error', function() {
		// log the error
	  });
}

function showWB(){

	if (endWB > 0){sublayersWB[endWB-1].remove();}
	endWB = endWB + 1;
	
	var MapQueryWB = "SELECT * FROM waterbodies_canv_nad83";
		
	var CartoCSSWB = "#waterbodies_canv_nad83{polygon-fill: #6baed6;polygon-opacity: 1;line-color: #6baed6;line-width: 0.5;line-opacity: 1;}";
	
	  cartodb.createLayer(map, layerWB)
	  .addTo(map)
	  .on('done', function(layer) {
		// change the query for the first layer
		var subLayerOptions = {
		  sql: MapQueryWB,
		  cartocss: CartoCSSWB,
		}
		var sublayer = layer.getSubLayer(0);
		sublayer.set(subLayerOptions);
		sublayersWB.push(sublayer);
		layer.setZIndex(7);
	  }).on('error', function() {
		// log the error
	  });
}	
/*
///////////////////////////////////////////////////////////////////////

var endRivers = 0;  
var sublayersRivers = [];

function clearRivers(){

	if (endRivers > 0){sublayersRivers[endRivers-1].remove();}
	endRivers = endRivers + 1;
	
	var MapQueryRivers = "SELECT * FROM osm_rivers_tsci_nad83 WHERE cartodb_id = 1";
		
	var CartoCSSRivers = "#osm_rivers_tsci_nad83{line-color: #6baed6;line-width: 0;line-opacity: 0;}";
	
	  cartodb.createLayer(map, layerRivers)
	  .addTo(map)
	  .on('done', function(layer) {
		// change the query for the first layer
		var subLayerOptions = {
		  sql: MapQueryRivers,
		  cartocss: CartoCSSRivers,
		}
		var sublayer = layer.getSubLayer(0);
		sublayer.set(subLayerOptions);
		sublayersRivers.push(sublayer);
		layer.setZIndex(6);
	  }).on('error', function() {
		// log the error
	  });
}

function showRivers(){

	if (endRivers > 0){sublayersRivers[endRivers-1].remove();}
	endRivers = endRivers + 1;
	
	var MapQueryRivers = "SELECT * FROM osm_rivers_tsci_nad83";
		
	var CartoCSSRivers = "#osm_rivers_tsci_nad83{line-color: #6baed6;line-width: 1.5;line-opacity: 0.65;[zoom>7]{line-width: 2;}[zoom>8]{line-width: 2.5;}[zoom>9]{line-width: 3.5;}[zoom>10]{line-width: 4;}[zoom>11]{line-width: 4.5;}[zoom>12]{line-width: 5;}[zoom>13]{line-width: 5.5;}[zoom>14]{line-width: 6;}[zoom>15]{line-width: 8;}}"
	
	  cartodb.createLayer(map, layerRivers)
	  .addTo(map)
	  .on('done', function(layer) {
		// change the query for the first layer
		var subLayerOptions = {
		  sql: MapQueryRivers,
		  cartocss: CartoCSSRivers,
		}
		var sublayer = layer.getSubLayer(0);
		sublayer.set(subLayerOptions);
		sublayersRivers.push(sublayer);
		layer.setZIndex(22);
	  }).on('error', function() {
		// log the error
	  });
}
*/
///////////////////////////////////////////////////////////////////////

var endWY = 0;  
var sublayersWY = [];

function clearWY(){

	if (endWY > 0){sublayersWY[endWY-1].remove();}
	endWY = endWY + 1;
	
	var MapQueryWY = "SELECT * FROM tcsi_huc10_geonad83 WHERE cartodb_id = 1";
		
	var CartoCSSWY = "#tcsi_huc10_geonad83{polygon-fill: #FFFFFF;polygon-opacity: 0;line-color: #FFF;line-width: 0;line-opacity: 0;}}";
	
	  cartodb.createLayer(map, layerWY)
	  .addTo(map)
	  .on('done', function(layer) {
		// change the query for the first layer
		var subLayerOptions = {
		  sql: MapQueryWY,
		  cartocss: CartoCSSWY,
		}
		var sublayer = layer.getSubLayer(0);
		sublayer.set(subLayerOptions);
		sublayersWY.push(sublayer);
		layer.setZIndex(6);
	  }).on('error', function() {
		// log the error
	  });
}

function showWY(){

	if (endWY > 0){sublayersWY[endWY-1].remove();}
	endWY = endWY + 1;
	
	var MapQueryWY = "SELECT * FROM tcsi_huc10_geonad83";
		
	var CartoCSSWY = "#tcsi_huc10_geonad83{polygon-fill: #eff3ff;polygon-opacity: 1;line-color: #000;line-width: 0.25;line-opacity: 0.75;}#tcsi_huc10_geonad83 [ pptmet_avg <= 1156.23] {polygon-fill: #084594;}#tcsi_huc10_geonad83 [ pptmet_avg <= 902.74] {polygon-fill: #2171b5;}#tcsi_huc10_geonad83 [ pptmet_avg <= 782.604] {polygon-fill: #4292c6;}#tcsi_huc10_geonad83 [ pptmet_avg <= 627.258] {polygon-fill: #6baed6;}#tcsi_huc10_geonad83 [ pptmet_avg <= 496.764] {polygon-fill: #9ecae1;}#tcsi_huc10_geonad83 [ pptmet_avg <= 426.346] {polygon-fill: #c6dbef;}#tcsi_huc10_geonad83 [ pptmet_avg <= 356.102] {polygon-fill: #eff3ff;}";

	  cartodb.createLayer(map, layerWY)
	  .addTo(map)
	  .on('done', function(layer) {
		// change the query for the first layer
		var subLayerOptions = {
		  sql: MapQueryWY,
		  cartocss: CartoCSSWY,
		}
		var sublayer = layer.getSubLayer(0);
		sublayer.set(subLayerOptions);
		sublayersWY.push(sublayer);
		layer.setZIndex(22);
		
	  }).on('error', function() {
		// log the error
	  });
}	

///////////////////////////////////////////////////////////////////////

var endBivar = 0;  
var sublayersBivar = [];

function clearBivar(){

	if (endBivar > 0){sublayersBivar[endBivar-1].remove();}
	endBivar = endBivar + 1;
	
	var MapQueryBivar = "SELECT * FROM tcsi_huc10_geonad83 WHERE cartodb_id = 1";
		
	var CartoCSSBivar = "#tcsi_huc10_geonad83{polygon-fill: #FFFFFF;polygon-opacity: 0;line-color: #FFF;line-width: 0;line-opacity: 0;}}";
	
	  cartodb.createLayer(map, layerBivar)
	  .addTo(map)
	  .on('done', function(layer) {
		// change the query for the first layer
		var subLayerOptions = {
		  sql: MapQueryBivar,
		  cartocss: CartoCSSBivar,
		}
		var sublayer = layer.getSubLayer(0);
		sublayer.set(subLayerOptions);
		sublayersBivar.push(sublayer);
		layer.setZIndex(6);
	  }).on('error', function() {
		// log the error
	  });
}

function showBivar(){

	// #e8e8e8 A1
	// #b0d5df
	// #64acbe
	// #e4acac B1
	// #ad9ea5
	// #627f8c
	// #c85a5a C1
	// #985356
	// #574249

	if (endBivar > 0){sublayersBivar[endBivar-1].remove();}
	endBivar = endBivar + 1;
	
	var MapQueryBivar = "SELECT * FROM tcsi_huc10_geonad83";
		
	var CartoCSSBivar = "#tcsi_huc10_geonad83{polygon-fill: #000;polygon-opacity: 1.0;line-color: #000;line-width: 0.25;line-opacity: 0.75;}#tcsi_huc10_geonad83 [ rk_bivar = 'A1'] {polygon-fill: #e8e8e8;}#tcsi_huc10_geonad83 [ rk_bivar = 'A2'] {polygon-fill: #b0d5df;}#tcsi_huc10_geonad83 [ rk_bivar = 'A3'] {polygon-fill: #64acbe;}#tcsi_huc10_geonad83 [ rk_bivar = 'B1'] {polygon-fill: #e4acac;}#tcsi_huc10_geonad83 [ rk_bivar = 'B2'] {polygon-fill: #ad9ea5;}#tcsi_huc10_geonad83 [ rk_bivar = 'B3'] {polygon-fill: #627f8c;}#tcsi_huc10_geonad83 [ rk_bivar = 'C1'] {polygon-fill: #c85a5a;}#tcsi_huc10_geonad83 [ rk_bivar = 'C2'] {polygon-fill: #985356;}#tcsi_huc10_geonad83 [ rk_bivar = 'C3'] {polygon-fill: #574249;}";

	  cartodb.createLayer(map, layerBivar)
	  .addTo(map)
	  .on('done', function(layer) {
		// change the query for the first layer
		var subLayerOptions = {
		  sql: MapQueryBivar,
		  cartocss: CartoCSSBivar,
		}
		var sublayer = layer.getSubLayer(0);
		sublayer.set(subLayerOptions);
		sublayersBivar.push(sublayer);
		layer.setZIndex(22);
		
	  }).on('error', function() {
		// log the error
	  });
}	

///////////////////////////////////////////////////////////////////////

var endFire = 0;  
var sublayersFire = [];

function clearFire(){

	if (endFire > 0){sublayersFire[endFire-1].remove();}
	endFire = endFire + 1;
	
	var MapQueryFire = "SELECT * FROM shurayrah_risk WHERE cartodb_id = 1";
		
	var CartoCSSFire = "#shurayrah_risk{polygon-fill: #FFFFFF;polygon-opacity: 0;line-color: #FFF;line-width: 0;line-opacity: 0;}}";
	
	  cartodb.createLayer(map, layerFire)
	  .addTo(map)
	  .on('done', function(layer) {
		// change the query for the first layer
		var subLayerOptions = {
		  sql: MapQueryFire,
		  cartocss: CartoCSSFire,
		}
		var sublayer = layer.getSubLayer(0);
		sublayer.set(subLayerOptions);
		sublayersFire.push(sublayer);
		layer.setZIndex(20);
	  }).on('error', function() {
		// log the error
	  });
}

function showFire(){

	if (endFire > 0){sublayersFire[endFire-1].remove();}
	endFire = endFire + 1;
	
	var MapQueryFire = "SELECT * FROM shurayrah_risk";
		
	var CartoCSSFire = "#shurayrah_risk{polygon-fill: #1a9850;polygon-opacity: 1;line-color: #FFF;line-width: 0;line-opacity: 1;}#shurayrah_risk [ dn <= 4] {polygon-fill: #d7191c;}#shurayrah_risk [ dn <= 4] {polygon-fill: #fdae61;}#shurayrah_risk [ dn <= 3] {polygon-fill: #ffffbf;}#shurayrah_risk [ dn <= 2] {polygon-fill: #a6d96a;}#shurayrah_risk [ dn <= 1] {polygon-fill: #1a9641;}";

	  cartodb.createLayer(map, layerFire)
	  .addTo(map)
	  .on('done', function(layer) {
		// change the query for the first layer
		var subLayerOptions = {
		  sql: MapQueryFire,
		  cartocss: CartoCSSFire,
		}
		var sublayer = layer.getSubLayer(0);
		sublayer.set(subLayerOptions);
		sublayersFire.push(sublayer);
		layer.setZIndex(30);
		
	  }).on('error', function() {
		// log the error
	  });
}	


//////////////////////////////////////////////////////////////////////////////
/*
function testFunction(){
	map.removeLayer("TSCI_basins");
	//addLayer(map);
}


$('.play').click(function(){
    var $this = $(this);
    $this.toggleClass('active');
    if($this.hasClass('active')){
        $this.text('pause');         
    } else {
        $this.text('play');
    }
});
*/
/*
var endZoomWB= 0;  
var sublayersZoomWB = [];

function zoomWB(){
	
	var nameWB = document.getElementsByName('myWB')[0].value; 	
	//alert(nameWB);

	var MapQueryZoomWB = "SELECT * FROM waterbodies_canv_nad83 WHERE name = '"+nameWB+"'";
	sql.getBounds(MapQueryZoomWB).done(function(bounds) {
	map.fitBounds(bounds);
	map.setZoom(9);
	
	// remove previous
	//if (endCounty > 0){sublayersCounty[endCounty-1].remove();}
	//endCounty = endCounty + 1;

	var CartoCSSZoomWB = "#waterbodies_canv_nad83{polygon-opacity:0.15;polygon-fill:#3182bd;line-opacity:1;line-color:#000;line-width:1;line-join: round;#ca_counties_wgs84_geo::labels[zoom>7]{text-name: [name];text-face-name: 'Lato Bold Italic';text-size: 14;text-spacing: 10;text-fill: #fff;text-halo-fill: rgba(40,92,148,0.75);text-halo-radius: 2.5;text-allow-overlap: true;text-placement: point;text-placement-type: simple;}[zoom < 9]{line-width:2}}";
	
	  cartodb.createLayer(map, layerWB)
	  .addTo(map)
	  .on('done', function(layer) {
		// change the query for the first layer
		var subLayerOptions = {
		  sql: MapQueryZoomWB,
		  cartocss: CartoCSSZoomWB,
		}
		var sublayer = layer.getSubLayer(0);
		layer.setZIndex(999);	
		sublayer.set(subLayerOptions);
		sublayersZoomWB.push(sublayer);
	  }).on('error', function() {
		// log the error
	  });
	})
}

*/



</script>
</body>

</html>

